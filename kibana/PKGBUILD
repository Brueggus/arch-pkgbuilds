# Maintainer: Levente Polyak <anthraxx[at]archlinux[dot]org>
# Contributor: Spider.007 <archlinux AT spider007 DOT net>

pkgname=kibana
pkgver=5.6.1
pkgrel=1
pkgdesc='Browser based analytics and search dashboard for Elasticsearch'
url='https://www.elastic.co/products/kibana'
arch=('any')
license=('Apache')
depends=('nodejs')
optdepends=('elasticsearch>=2.4')
backup=('etc/kibana/kibana.yml')
options=('!strip' 'emptydirs')
install=kibana.install
source=(https://artifacts.elastic.co/downloads/${pkgname}/${pkgname}-${pkgver}-linux-x86_64.tar.gz
        kibana.service)
sha256sums=('dc52083e3ca7f7479d63831aae60cff2e0f03f4e8a65d744bc79d66bc285b009'
            '85d62ab2d8e2667746303f98b055fcc6eae6bde8d378563c1b56057998eb3c98')
sha512sums=('b7fccd1bbd9a884f3b8b46ca8f166561d17935215607ff7f2c6fc20a423e4c81b2a1a0302419b86a75641bc634c7f5a8c0096d284cac0c8e7344e60baa818235'
            '573942289964f554541222d2e8cd7851f5a94cabf3d1a26b734fb5f3efbbe5214f0c110eef2eeadd6185ba8765f6e5ab53fc8f40dea7fad5f51fee70cf20a787')

package() {
  cd ${pkgbase}-${pkgver}-linux-x86_64

  install -dm 755 "${pkgdir}/usr/share/kibana"
  cp -a * "${pkgdir}/usr/share/kibana"

  install -dm 750 "${pkgdir}/etc/kibana"
  install -Dm 640 config/kibana.yml -t "${pkgdir}/etc/kibana"
  install -Dm 644 "${srcdir}/kibana.service" -t "${pkgdir}/usr/lib/systemd/system"

  chown -R 206:206 "${pkgdir}"/usr/share/kibana/{optimize,data} "${pkgdir}/etc/kibana"
  rm -r "${pkgdir}/usr/share/kibana/node"
}

# vim: ts=2 sw=2 et:
